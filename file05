edited on bugfix103 branch by anco
